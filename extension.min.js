let arrNodes=[];let url=document.URL.split("/");if(url.includes("kanban_deister")&&url.includes("kanban")&&url.includes("rest")){let e=document.querySelector("#appBarScrollTarget button");let t=setInterval(()=>{console.log("INTERVAL");e=document.querySelector("#appBarScrollTarget button");if(e){e.addEventListener("click",setTimeSheetFormat);clearInterval(t)}},1e3)}if(document.URL.indexOf("dbstudio")!=-1){window.addEventListener("beforeunload",e=>{e.preventDefault();e.returnValue=""});openPDF()}document.addEventListener("keydown",function(o){if(o.shiftKey&&o.keyCode===13){o.preventDefault();let e=document.querySelector(".v-window-item--active>.dbstudio-flex-header-body .fa.fa-play");let l=document.getElementsByClassName("x-panel-bbar")[1];let t=[...document.querySelectorAll('[id*="btnInnerEl"]')].filter(e=>e.innerHTML=="Execute").find(e=>!e.closest(".x-panel.x-tabpanel-child.x-panel-default").style["display"]);let n=document.querySelector("textarea");if(e){e.closest("button").click()}else if(l){[...l.getElementsByTagName("button")].at(-1).click();let t=document.querySelector(".x-window.x-resizable-pinned");if(t){let e=setInterval(()=>{if(t.style.left.substring(0,t.style.left.length-2)<0){n.focus();clearInterval(e)}})}}else if(t){t.click();let e=setInterval(()=>{if(!t.closest("a").classList.contains("x-item-disabled")){n.focus();clearInterval(e)}},1e3)}else{buscarPrimerNieto(document.querySelector(".v-window-item--active"),"v-window-item--active").querySelector(".fa.fa-play").click()}}let e=document.activeElement.closest(".v-window-item--active")?.querySelector(".v-icon.mdi.mdi-content-save-outline")||document.querySelector(".v-icon.mdi.mdi-content-save-outline")||[...document.querySelectorAll(".v-icon.material-icons")].find(e=>e.innerHTML=="save");if(e)e.addEventListener("click",autoNotes);if(o.key=="s"&&o.metaKey)autoNotes();if(o.ctrlKey){switch(o.keyCode){case 87:prevResult(o);break;case 83:nextResult(o);break;case 85:nextTab(o);break;case 89:newTab();break;case 76:nextTab(o,true);break;case 72:clearCache();break;case 68:duplicateTab(o);break;case 79:openDBStudio(o);break;case 73:explorer();break}}});function openPDF(){let e=[...document.querySelectorAll(".editor-resultset-container")].at(-1);const t=function(e,t){console.log(e);for(const l of e){if(l.type==="childList"){console.log("Nodos añadidos:",l.addedNodes);for(let e of l.addedNodes){if(e&&e.nodeName&&e.nodeName!="#comment"&&e.classList.contains("active-tab-rs")){e.querySelectorAll("table tbody tr").forEach(e=>{let t=e.querySelector(".v-icon.notranslate.mdi.mdi-content-save");if(t){t.closest("a").removeAttribute("download");t.closest("a").setAttribute("target","blank")}})}}}}};const l=new MutationObserver(t);const n={childList:true};let o=setInterval(()=>{if(e&&!arrNodes.includes(e)){arrNodes.push(e);l.observe(e,n);clearInterval(o);console.log(arrNodes)}else{e=[...document.querySelectorAll(".editor-resultset-container")].at(-1)}},1e3)}function autoNotes(){let e=document.querySelector('[data-ax-id*="_notes"], [id*="rcs_notes"]');if(e.value=="")e.value="fix";let t=new Event("input",{bubbles:true,cancelable:true});e.focus();e.dispatchEvent(t);clearCache()}function clearCache(){let e=document.querySelector(".mdi-memory")||[...document.querySelectorAll(".material-icons")].find(e=>e.innerHTML=="memory");if(e)e.click();else{let t="/webOS/jobstool/";fetch(t).then(e=>e.ok?window.open(t):null)}}function duplicateTab(e){e.preventDefault();window.open(document.URL)}function openDBStudio(e){e.preventDefault();let t="/os/dbstudio#/databases";let l="/webOS/dbstudio/";fetch(l).then(e=>window.open(e.ok?l:t))}function explorer(){fetch("/webOS/dbstudio/").then(e=>{if(e.ok){window.open("/webOS/explorer/")}})}function setTimeSheetFormat(){let e=document.querySelector(".v-dialog--active textarea");e.value="- Solicitante: \n- Descripción: \n- Estado actual: ";e.focus();let t=new Event("input",{bubbles:true,cancelable:true});e.dispatchEvent(t);e.setSelectionRange(15,15)}function nextResult(e){e.preventDefault();let t=document.querySelector(".v-window-item--active .ax-grid-selected-row")||document.querySelector(".v-window-item--active .ax-grid-row__selected");let l=t.nextElementSibling;if(l){l.firstElementChild.click()}else{t.parentNode.querySelector(".ax-grid-content-row").firstElementChild.click()}}function prevResult(e){e.preventDefault();let t=document.querySelector(".v-window-item--active .ax-grid-selected-row")||document.querySelector(".v-window-item--active .ax-grid-row__selected");let l=t.previousElementSibling;if(l&&!l.classList.contains("ax-grid-row__control-width")){l.firstElementChild.click()}else{[...t.parentNode.querySelectorAll(".ax-grid-content-row")].at(-1).firstElementChild.click()}}function buscarPrimerNieto(e,n){let o=[e];let c=null;while(o.length>0){let e=o.shift();let l=e.children;for(let t=0;t<l.length;t++){let e=l[t];if(e.classList.contains(n)){o=[...e.children];c=e;break}o.push(e)}}return c}async function newTab(){let e=document.querySelectorAll(".v-slide-group__content.v-tabs-bar__content")[1]||document.querySelectorAll(".v-slide-group__content.v-tabs-bar__content")[0];let t=e.querySelector(".v-tab.v-tab--active :first-child");let l=new Event("contextmenu",{bubbles:true,cancelable:true});await t.dispatchEvent(l);document.querySelector(".v-list-item__title").click();document.querySelector(".menuable__content__active .v-list-item__title").closest('[role="menu"]').style.display="none";openPDF()}function nextTab(e,t){e.preventDefault();let l=document.querySelectorAll(".v-slide-group__content.v-tabs-bar__content")[1]||document.querySelectorAll(".v-slide-group__content.v-tabs-bar__content")[0];l=l.querySelector(".v-tab.v-tab--active");if(t)return l.lastElementChild.click();if(l.nextElementSibling){l.nextElementSibling.click()}else{l.parentNode.querySelector(".v-tab").click()}}